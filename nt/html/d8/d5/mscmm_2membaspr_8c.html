<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: mscmm/membaspr.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>membaspr.c File Reference</h1><code>#include "Windef.h"</code><br>
<code>#include "WinGdi.h"</code><br>
<code>#include &lt;wtypes.h&gt;</code><br>
<code>#include &lt;winbase.h&gt;</code><br>
<code>#include &lt;windowsX.h&gt;</code><br>
<code>#include "ICM.h"</code><br>
<code>#include "General.h"</code><br>
<code>#include "MemProf.h"</code><br>

<p>
<a href="../../d9/d4/mscmm_2membaspr_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/mscmm_2membaspr_8c.html#a0">MyTagCount</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/mscmm_2membaspr_8c.html#a1">LINK_BUFFER_MAX</a>&nbsp;&nbsp;&nbsp;3000</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a11">CMError</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d5/mscmm_2membaspr_8c.html#a2">DeviceLinkFill</a> (<a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a> cw, <a class="el" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a> *profileSet, <a class="el" href="../../d6/d3/structicProfile.html">icProfile</a> **theProf, unsigned long aIntent)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="mscmm/membaspr.c::LINK_BUFFER_MAX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LINK_BUFFER_MAX&nbsp;&nbsp;&nbsp;3000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html#l00038">38</a> of file <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html">mscmm/membaspr.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="mscmm/membaspr.c::MyTagCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MyTagCount&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html#l00037">37</a> of file <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html">mscmm/membaspr.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="mscmm/membaspr.c::DeviceLinkFill" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a11">CMError</a> DeviceLinkFill           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d6/w98_2lh__open_2pi__app_8h.html#a28">CMWorldRef</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d3/structCMConcatProfileSet.html">CMConcatProfileSet</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>profileSet</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d3/structicProfile.html">icProfile</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>theProf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>aIntent</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html#l00040">40</a> of file <a class="el" href="../../d9/d4/mscmm_2membaspr_8c-source.html">mscmm/membaspr.c</a>.
<p>
References <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00337">BlockMove()</a>, <a class="el" href="../../d3/d5/lh__open_2pi__app_8h-source.html#l00023">CMError</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00043">CMHelperICC2int32Const</a>, <a class="el" href="../../d4/d6/lh__core_2typedefs_8h-source.html#l00188">CMMModelPtr</a>, <a class="el" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a31">cmProfileError</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00906">icTagList::count</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00099">DisposeIfPtr()</a>, <a class="el" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a7">GetSizes()</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00139">icSigAToB0Tag</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00151">icSigCopyrightTag</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00267">icSigLinkClass</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00161">icSigMediaWhitePointTag</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00166">icSigProfileDescriptionTag</a>, <a class="el" href="../../d8/d3/aug98_2dll32_2icc_8h-source.html#l00167">icSigProfileSequenceDescTag</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l01279">LINK_BUFFER_MAX</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00521">MyAdd_NL_AToB0Tag_mft1()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00619">MyAdd_NL_AToB0Tag_mft2()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00222">MyAdd_NL_ColorantTag()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00245">MyAdd_NL_CopyrightTag()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00178">MyAdd_NL_DescriptionTag()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00053">MyAdd_NL_Header()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00724">MyAdd_NL_SequenceDescTag()</a>, <a class="el" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a4">MyGetColorSpaces()</a>, <a class="el" href="../../d1/d5/lh__core_2memlink_8c-source.html#l00941">MyTagCount</a>, <a class="el" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>, <a class="el" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a16">NoNamedColorProfile</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00899">icTag::offset</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00071">OSErr</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00070">OSType</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00052">Ptr</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00898">icTag::sig</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00901">icTag::size</a>, <a class="el" href="../../d7/d6/lh__open_2pi__mem_8c-source.html#l00072">SmartNewPtrClear()</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00937">icProfile::tagList</a>, <a class="el" href="../../d6/d6/mscmm_8w98_2lh__core_2profile_8h-source.html#l00907">icTagList::tags</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00032">UINT32</a>, <a class="el" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>, <a class="el" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a26">WriteProf()</a>, <a class="el" href="../../d4/d5/w98_2lh__core_2memlink_8h-source.html#l00026">MyDoubleXYZ::X</a>, <a class="el" href="../../d4/d5/w98_2lh__core_2memlink_8h-source.html#l00026">MyDoubleXYZ::Y</a>, and <a class="el" href="../../d4/d5/w98_2lh__core_2memlink_8h-source.html#l00026">MyDoubleXYZ::Z</a>.
<p>
<pre class="fragment"><div>00042 {
00043         <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a11">CMError</a>                 err = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>;
00044         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a35">OSErr</a>                   aOSerr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a56">unimpErr</a>;
00045 <span class="preprocessor">#ifdef __MWERKS__</span>
00046 <span class="preprocessor"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                   theText[] = <span class="stringliteral">"\pDeviceLink profile  "</span>;
00047 <span class="preprocessor">#else</span>
00048 <span class="preprocessor"></span>      <span class="keywordtype">char</span>                      theText[] = <span class="stringliteral">"\026DeviceLink profile   "</span>;
00049 <span class="preprocessor">#endif</span>
00050 <span class="preprocessor"></span>      <span class="keywordtype">char</span>      copyrightText[] = <span class="stringliteral">"\037©1996 by Linotype-Hell  U.J.K."</span>;
00051         <a class="code" href="../../d6/d3/structicProfile.html">icProfile</a>               *aProf=0;
00052         <span class="keywordtype">long</span>                    theTagTabSize;
00053         <span class="keywordtype">long</span>                    theHeaderSize;
00054         <span class="keywordtype">long</span>                    theDescSize;
00055         <span class="keywordtype">long</span>                    theMediaSize;
00056         <span class="keywordtype">long</span>                    theSequenceDescSize;
00057         <span class="keywordtype">long</span>                    theA2B0Size;
00058         <span class="keywordtype">long</span>                    theCopyRightSize;
00059         <span class="keywordtype">long</span>                    currentSize=0;
00060         <span class="keywordtype">long</span>                    theTotalSize=0;
00061         <a class="code" href="../../d5/d4/structicTag.html">icTag</a>                   aTag;
00062         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a8">UINT32</a>                  sCS,dCS,clutSize;
00063         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>                             aPtr=0;
00064 
00065         <a class="code" href="../../d5/d1/structMyDoubleXYZ.html">MyDoubleXYZ</a> D50XYZ = { 0.9642, 1.0000, 0.8249 };
00066         <a class="code" href="../../d8/d6/structicXYZNumber.html">icXYZNumber</a> D50 = { (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(D50XYZ.<a class="code" href="../../d5/d1/structMyDoubleXYZ.html#o0">X</a> * 65536), (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(D50XYZ.<a class="code" href="../../d5/d1/structMyDoubleXYZ.html#o1">Y</a> * 65536), (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)(D50XYZ.<a class="code" href="../../d5/d1/structMyDoubleXYZ.html#o2">Z</a> * 65536)};
00067         theHeaderSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>);
00068         theDescSize   =                                                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>)                        <span class="comment">/* type descriptor */</span>
00069                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)         <span class="comment">/* reserved */</span>
00070                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)         <span class="comment">/* ASCII length */</span>
00071                                                                                                                 + theText[0]                            <span class="comment">/* ASCII profile description */</span>
00072                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)         <span class="comment">/* Unicode code */</span>
00073                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)         <span class="comment">/* Unicode character count */</span>
00074                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>)        <span class="comment">/* Macintosh script code */</span>
00075                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)         <span class="comment">/* Macintosh string length */</span>
00076                                                                                                                 + 67                                            <span class="comment">/* Macintosh string */</span>
00077                                                                                                                 ;
00078         theCopyRightSize   =                                                              <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a34">OSType</a>)                        <span class="comment">/* type descriptor */</span>
00079                                                                                                                 + <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)         <span class="comment">/* reserved */</span>
00080                                                                                                                 + copyrightText[0]                      <span class="comment">/* ASCII profile description */</span>
00081                                                                                                                 ;
00082         theMediaSize = <span class="keyword">sizeof</span>( <a class="code" href="../../d9/d6/structicXYZType.html">icXYZType</a> );;
00083 
00084         theTagTabSize = <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a3">MyTagCount</a> * <span class="keyword">sizeof</span>( <a class="code" href="../../d5/d4/structicTag.html">icTag</a> ) + <span class="keyword">sizeof</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> );
00085         
00086         *theProf = 0;
00087         
00088         <span class="keywordflow">if</span>( ((<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)cw)-&gt;hasNamedColorProf != <a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a20a16">NoNamedColorProfile</a> ){
00089                 err = <a class="code" href="../../d2/d6/lh__open_2pi__app_8h.html#a149a31">cmProfileError</a>;
00090                 <span class="keywordflow">goto</span> CleanupAndExit;
00091         }
00092         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a4">MyGetColorSpaces</a>( profileSet, &amp;sCS, &amp;dCS );
00093         <span class="keywordflow">if</span> (err)
00094                 <span class="keywordflow">goto</span> CleanupAndExit;
00095                 
00096         aProf = (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a6">SmartNewPtrClear</a>( LINK_BUFFER_MAX, &amp;aOSerr );
00097         err = aOSerr;
00098         <span class="keywordflow">if</span> (err)
00099                 <span class="keywordflow">goto</span> CleanupAndExit;
00100 
00101         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a6">MyAdd_NL_Header</a>(theTotalSize, (<a class="code" href="../../d1/d2/structicHeader.html">icHeader</a>*)((Ptr)aProf+currentSize), aIntent, icSigLinkClass, sCS, dCS );
00102         <span class="keywordflow">if</span> (err)
00103                 <span class="keywordflow">goto</span> CleanupAndExit;
00104                 
00105         <span class="comment">/*----------------------------------------------------------------------------------------- cmProfileDescriptionTag */</span>
00106         currentSize = theHeaderSize + theTagTabSize;
00107         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o0">count</a> ), MyTagCount);
00108 
00109         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o0">sig</a> ), icSigProfileDescriptionTag);
00110         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o1">offset</a> ), currentSize);
00111         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o2">size</a> ), theDescSize);
00112         aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o1">tags</a>[0] = aTag;
00113         err =<a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a7">MyAdd_NL_DescriptionTag</a>    ( (CMTextDescriptionType *)((Ptr)aProf+currentSize), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)theText );
00114         <span class="keywordflow">if</span> (err)
00115                 <span class="keywordflow">goto</span> CleanupAndExit;  
00116         currentSize += theDescSize;
00117         currentSize = ( currentSize + 3 ) &amp; ~ 3;
00118 
00119         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o0">sig</a> ), icSigMediaWhitePointTag);
00120         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o1">offset</a> ), currentSize );
00121         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o2">size</a> ), theMediaSize);
00122         aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o1">tags</a>[1] = aTag;
00123         <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a8">MyAdd_NL_ColorantTag</a>((<a class="code" href="../../d9/d6/structicXYZType.html">icXYZType</a> *)((Ptr)aProf+currentSize), &amp;D50);
00124         currentSize += theMediaSize;
00125         currentSize = ( currentSize + 3 ) &amp; ~ 3;
00126 
00127         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o0">sig</a> ), icSigCopyrightTag);
00128         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o1">offset</a> ), currentSize );
00129         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o2">size</a> ), theCopyRightSize);
00130         aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o1">tags</a>[2] = aTag;
00131         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a10">MyAdd_NL_CopyrightTag</a>( (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)copyrightText, (CMTextType *)((Ptr)aProf+currentSize));
00132         <span class="keywordflow">if</span> (err)
00133                 <span class="keywordflow">goto</span> CleanupAndExit;
00134         currentSize += theCopyRightSize;
00135         currentSize = ( currentSize + 3 ) &amp; ~ 3;
00136                 
00137         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a11">MyAdd_NL_SequenceDescTag</a>( profileSet, (<a class="code" href="../../d8/d3/structicProfileSequenceDescType.html">icProfileSequenceDescType</a> *)((Ptr)aProf+currentSize), &amp;theSequenceDescSize );
00138         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o0">sig</a> ), icSigProfileSequenceDescTag);
00139         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o1">offset</a> ), currentSize );
00140         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o2">size</a> ), theSequenceDescSize);
00141         aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o1">tags</a>[3] = aTag;
00142         currentSize += theSequenceDescSize;
00143         currentSize = ( currentSize + 3 ) &amp; ~ 3;
00144 
00145     theA2B0Size = <a class="code" href="../../d0/d7/w98_2mscmm_2memprof_8h.html#a7">GetSizes</a>( (CMMModelPtr)cw, &amp;clutSize );
00146 
00147         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o0">sig</a> ), icSigAToB0Tag);
00148         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o1">offset</a> ), currentSize );
00149         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>(&amp;(aTag.<a class="code" href="../../d5/d4/structicTag.html#o2">size</a> ), theA2B0Size);
00150         aProf-&gt;<a class="code" href="../../d6/d3/structicProfile.html#o3">tagList</a>.<a class="code" href="../../d7/d4/structicTagList.html#o1">tags</a>[4] = aTag;
00151 
00152         <span class="comment">/* aPtr =  SmartNewPtr( theA2B0Size+currentSize, &amp;aOSerr );</span>
00153 <span class="comment">        err = aOSerr;</span>
00154 <span class="comment">        if( err ){</span>
00155 <span class="comment">                goto CleanupAndExit;</span>
00156 <span class="comment">        }*/</span>
00157         aPtr = GlobalAllocPtr( GHND, theA2B0Size+currentSize );
00158 
00159         <span class="keywordflow">if</span>( aPtr == 0 ){
00160                 err = GetLastError();
00161                 <span class="keywordflow">goto</span> CleanupAndExit;
00162         }
00163 
00164         <span class="keywordflow">if</span> ( ((<a class="code" href="../../d3/d7/lh__core_2typedefs_8h.html#a13">CMMModelPtr</a>)cw)-&gt;lutParam.colorLutWordSize == 8 )
00165         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a12">MyAdd_NL_AToB0Tag_mft1</a>( (CMMModelPtr)cw, (<a class="code" href="../../d9/d2/structicLut8Type.html">icLut8Type</a> *)(aPtr+currentSize), clutSize );
00166     <span class="keywordflow">else</span>
00167         err = <a class="code" href="../../d3/d6/w98_2lh__core_2memlink_8h.html#a13">MyAdd_NL_AToB0Tag_mft2</a>( (CMMModelPtr)cw, (<a class="code" href="../../d7/d2/structicLut16Type.html">icLut16Type</a> *)(aPtr+currentSize), clutSize );
00168 
00169         <span class="keywordflow">if</span> (err)
00170                 <span class="keywordflow">goto</span> CleanupAndExit;
00171 
00172         <a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a10">BlockMove</a>( (Ptr)aProf, aPtr, currentSize );
00173         aProf = (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr)aProf );
00174 
00175         <a class="code" href="../../d0/d6/lh__core_2memlink_8c.html#a1">CMHelperICC2int32Const</a>( aPtr, theA2B0Size+currentSize );
00176 
00177         *theProf = (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)aPtr;
00178 <span class="preprocessor">#ifdef WRITE_PROFILE</span>
00179 <span class="preprocessor"></span>        <a class="code" href="../../d9/d6/w98_2mscmm_2icm32_8c.html#a26">WriteProf</a>( <span class="stringliteral">"DeviceLinkFill.pf"</span>, (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)aPtr, theA2B0Size+currentSize );
00180 <span class="preprocessor">#endif</span>
00181 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a58a55">noErr</a>;
00182         
00183 CleanupAndExit:
00184         *theProf = (<a class="code" href="../../d6/d3/structicProfile.html">icProfile</a> *)<a class="code" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a4">DisposeIfPtr</a>( (Ptr)aProf );
00185         <span class="keywordflow">if</span>( aPtr )GlobalFreePtr( aPtr );
00186         <span class="keywordflow">return</span> err;
00187 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:37 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
